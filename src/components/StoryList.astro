---
import { getCollection } from 'astro:content';

export interface Props {
  stories?: any[];
}

const { stories } = Astro.props;

// If no stories are passed, fetch all stories and sort them by date
let displayStories = stories || [];
if (!stories || stories.length === 0) {
  const allStories = await getCollection('stories');
  displayStories = allStories.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
}
---
{displayStories.map(story => (
  <div class="post">
    <div class="post-date">{new Date(story.data.date).toLocaleString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }).toLowerCase()}</div>
    <div class="post-title">
      <a href={`/stories/${story.id}/`}>{story.data.title}</a>
    </div>
    <div class="post-summary">{story.data.description}</div>
  </div>
))} 

<style>

a {
  text-decoration-style: underline dashed;
  text-decoration-color: var(--color-dark);
  color: var(--color-dark);
}

a:hover {
  text-decoration: underline dashed;
  text-decoration-color: var(--color-link-hover);
  color: var(--color-link-hover);
}

</style>